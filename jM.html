<!doctype html><html lang=ko><meta charset=UTF-8><meta content="IE=edge"http-equiv=X-UA-Compatible><meta content="width=device-width,initial-scale=1"name=viewport><title>ìš©í™”ì‚¬ ì‚¬ì°° ì›¹ì‚¬ì´íŠ¸ | ì¢…ë¬´í–‰ì •</title><link href=https://unpkg.com/swiper/swiper-bundle.min.css rel=stylesheet><style>*{margin:0;padding:0;box-sizing:border-box}body,html{min-width:1280px;overflow-x:auto}body{font-family:'Noto Sans KR',sans-serif;background:#fafafa;color:#333;line-height:1.6}img,video{max-width:100%;display:block}a{text-decoration:none;color:inherit}#wrapper{width:clamp(1280px,100%,1920px);min-width:1280px;max-width:1440px;height:clamp(860px,100%,1080px);min-height:740px;max-height:1080px;margin:0 auto}.header-top{background:#fff;padding:.75rem 2rem;display:flex;align-items:center;justify-content:center;gap:.5rem;font-size:1rem;color:#333;border-bottom:1px solid #eaeaea}.header-top img{justify-content:center;width:250px;height:105px}.header-top .divider{color:#ccc;margin:0 .75rem}.header-top .temple-name{font-weight:700}:root{--menu-width:1200px;--menu-gap:10rem}nav.main-nav{background:#fff;position:relative;padding:.5rem 2rem;overflow:visible}nav.main-nav>ul{display:flex;justify-content:center;flex-wrap:nowrap;list-style:none;gap:10rem;white-space:nowrap;font-weight:500;max-width:1200px;margin:0 auto;position:relative}nav.main-nav ul li{position:relative;padding:0}nav.main-nav>ul>li:not(:last-child)::after{content:"|";font-size:larger;position:absolute;right:-5rem;color:#333}nav.main-nav ul li>a{color:#333;white-space:nowrap;padding:1rem;transition:color .2s;font-size:larger}nav.main-nav ul li>a:hover{color:#b9a26a}nav.main-nav>ul.menu{max-width:var(--menu-width);margin:0 auto;gap:var(--menu-gap)}nav.main-nav>ul.menu>li+li::after{right:calc(-.5 * var(--menu-gap))}nav.main-nav .mega-submenu{left:50%;transform:translateX(-50%);width:var(--menu-width);max-width:var(--menu-width)}nav.main-nav .mega-submenu{display:grid;grid-template-columns:repeat(5,max-content);column-gap:8rem;position:absolute;top:100%;left:0;justify-content:center;width:100%;max-width:1920px;padding:2rem;background:#fff;box-shadow:0 2px 8px rgba(0,0,0,.1);box-sizing:border-box;opacity:0;pointer-events:none;transform:translateY(-10px);transition:opacity .3s ease,transform .3s ease-out;z-index:50}nav.main-nav:hover .mega-submenu{opacity:1;pointer-events:auto;transform:translateY(0)}nav.main-nav .mega-submenu .group{text-align:left;padding:0 .25rem;box-sizing:border-box}nav.main-nav .mega-submenu .group ul{list-style:none;padding:0;margin:0}nav.main-nav .mega-submenu .group ul li+li{margin-top:.35rem;padding-left:0}nav.main-nav .mega-submenu .group a{color:#333;text-decoration:none;transition:color .2s}nav.main-nav .mega-submenu .group a:hover{color:#b9a26a}nav.main-nav:hover .mega-submenu{opacity:1;pointer-events:auto;transform:translateY(0)}@media (max-width:1360px){nav.main-nav .mega-submenu{grid-template-columns:repeat(5,1fr);gap:3.5rem}}.page-hero{position:relative;min-height:360px;background-image:var(--hero, url('/Users/junjun/Downloads/Project/2/003.png'));background-size:cover;background-position:center}.page-hero::before{content:"";position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,.08) 35%,rgba(0,0,0,.5) 100%)}.ph-inner{position:absolute;inset:0;left:50%;transform:translateX(-50%);max-width:var(--menu-width);display:flex;flex-direction:column;justify-content:center;align-items:center;padding:2rem 1rem;color:#fff;text-align:center}.ph-title{font-size:clamp(1.8rem,2.4vw + 1rem,3rem);font-weight:800;letter-spacing:.03em;text-shadow:0 3px 12px rgba(0,0,0,.35);margin-bottom:.8rem}.breadcrumbs{display:flex;align-items:center;gap:.5rem;font-size:.95rem;opacity:.95;margin-bottom:.9rem}.breadcrumbs a{color:#fff}.breadcrumbs .sep{opacity:.6}.subnav{position:absolute;bottom:14px;left:50%;transform:translateX(-50%);display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:1rem 2rem;max-width:var(--menu-width);padding:.25rem .75rem}.subnav li{list-style:none;position:relative}.subnav li+li::before{content:"â€¢";position:absolute;left:-1.2rem;top:50%;transform:translateY(-50%);color:rgba(255,255,255,.65)}.subnav a{color:#fff;padding:.35rem .6rem;border-radius:999px;transition:.2s ease;white-space:nowrap}.subnav a:hover{background:rgba(255,255,255,.12)}.subnav a.active{background:rgba(0,0,0,.28);box-shadow:inset 0 0 0 1px rgba(255,255,255,.35)}.sheet{max-width:var(--menu-width);margin:2rem auto;padding:2rem;background:#fff;border-radius:6px;box-shadow:0 2px 6px rgba(0,0,0,.08);position:relative}.sheet::after{content:"";position:absolute;left:2rem;right:2rem;bottom:-10px;height:8px;border-radius:999px}.tab-panel{display:none}.tab-panel.is-active{display:block}.board-toolbar{display:flex;gap:.5rem;justify-content:flex-end;margin-bottom:.75rem}.input,.select{padding:.5rem .6rem;border:1px solid #ddd;border-radius:8px;background:#fff}.btn{display:inline-flex;align-items:center;padding:.5rem .9rem;border:1px solid #ccc;border-radius:8px;background:#fff;cursor:pointer}.btn:hover{border-color:#999}.board{width:100%;border-collapse:collapse;background:#fff;overflow:hidden;border-radius:8px}.board thead th{background:#faf7ef;border-bottom:2px solid #e9dcc2;padding:.75rem .75rem;text-align:left;white-space:nowrap}.board tbody td{border-bottom:1px solid #eee;padding:.75rem .75rem}.board .tag{display:inline-block;background:#e9dcc2;color:#7a5b1a;border-radius:999px;font-size:.78rem;padding:.2rem .55rem;margin-right:.5rem}.board .file{opacity:.55}.pager{display:flex;gap:.35rem;justify-content:center;margin:1rem 0}.pager .btn{padding:.4rem .7rem}.pager .btn.current{border-color:#b9a26a}@media(max-width:1360px){nav.main-nav .mega-submenu{column-gap:3.5rem}}@media(max-width:1024px){.page-hero{min-height:300px}.subnav{gap:.8rem 1.2rem}.subnav li+li::before{left:-1rem}}:root{--cal-head:#a99986;--cal-head-text:#fff;--cal-border:#e8e1d5;--cal-muted:#999;--cal-sun:#E86C00}.cal-wrap{max-width:var(--menu-width);margin:0 auto}.cal-header{display:flex;justify-content:center;align-items:center;gap:1rem;margin:.75rem 0 1rem}.cal-title{font-size:1.75rem;font-weight:700}.cal-nav{width:36px;height:36px;border-radius:50%;border:1px solid #ddd;background:#fff;cursor:pointer;line-height:34px;font-size:1.2rem}.cal-nav:hover{border-color:#bbb}.cal-grid{display:grid;grid-template-columns:repeat(7,1fr);border:1px solid var(--cal-border);background:#fff;overflow:hidden;border-radius:8px}.cal-cell{border-right:1px solid var(--cal-border);border-bottom:1px solid var(--cal-border)}.cal-cell.head{background:var(--cal-head);color:var(--cal-head-text);text-align:center;font-weight:600;padding:.75rem 0}.cal-day{min-height:140px;padding:8px 10px;position:relative;background:#fff}.cal-day.is-out{background:#fafafa}.cal-day .date{font-weight:600}.cal-day.sun .date{color:var(--cal-sun)}.cal-day.sat .date{color:#666}.cal-day.is-today{outline:2px solid rgba(185,162,106,.45);outline-offset:-2px}.cal-events{margin-top:6px;font-size:.92rem;color:#666;list-style:none}.cal-events li{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.cal-events li::before{content:"Â· ";color:#bbb}.cal-note{color:var(--cal-muted);margin-top:.6rem;font-size:.9rem}.footer-links{background:#b9a26a;padding:.75rem 1rem}.footer-links ul{display:flex;justify-content:flex-start;gap:.65rem;padding-left:.75rem;list-style:none;font-size:.95rem}.footer-links ul li{position:relative}.footer-links ul li:not(:last-child)::after{content:"/";margin:0 .75rem;color:rgba(255,255,255,.7)}.footer-links ul li a{color:#fff;transition:color .2s}.footer-links ul li a:hover{color:#333}.footer-info{background:#333;color:#fff;text-align:start;padding:1.5rem 1.5rem;line-height:1.4}.footer-info .account{color:#efc964;font-weight:600;margin-bottom:.75rem}.footer-info .address{font-size:.9rem;opacity:.85}.footer-info .name{text-align:right;padding-right:4rem;font-size:larger;font-style:italic;opacity:.6}.footer-bottom{background:#222;color:#ccc;display:flex;justify-content:space-between;align-items:center;padding:.75rem 1rem;font-size:.85rem}#toTop{position:fixed;bottom:20px;right:20px;background:#fff;color:#222;padding:0;border-radius:50%;cursor:pointer;display:none;box-shadow:0 2px 6px rgba(0,0,0,.2);width:32px;height:32px;display:flex;align-items:center;justify-content:center}.admin-only{display:none!important}body.admin-logged-in .admin-only{display:initial!important}.admin-rail{position:fixed;right:16px;bottom:16px;z-index:9999;display:flex;gap:8px;align-items:center;background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 10px 24px rgba(0,0,0,.08);padding:8px 10px}.admin-rail .btn{height:36px;padding:0 12px;border-radius:8px;border:1px solid #ddd;background:#fff;cursor:pointer}.admin-rail .btn-primary{background:#b9a26a;color:#fff;border:0}body.is-editing [contenteditable=true]{outline:2px dashed #b9a26a;outline-offset:2px;border-radius:6px}.edit-actions{position:absolute;right:6px;top:6px;z-index:5;display:flex;gap:6px}.edit-actions .btn-mini{height:28px;padding:0 10px;border-radius:6px;border:1px solid #ddd;background:#fff;cursor:pointer;font-size:.9rem}.dialog{border:0;border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,.18);width:min(560px,90vw);padding:18px}.dialog::backdrop{background:rgba(0,0,0,.45)}.form-row{display:flex;flex-direction:column;gap:.35rem;margin:.5rem 0}.form-row input,.form-row textarea{border:1px solid #e5e7eb;border-radius:10px;padding:10px 12px}.row{display:flex;gap:8px;align-items:center}</style><div class=wrapper><header><div class=header-top><a href=index.html><img alt="ì²œíƒœì‚° ìš©í™”ì‚¬ ë§ˆí¬"src=./assets/img/logo.png> <span class=divider></span> <span class=temple-name></span></a></div><nav class=main-nav><ul class=menu><li><a href=yonghasa.html#greeting>ì²œíƒœì‚° ìš©í™”ì‚¬</a><li><a href=jM.html#notice>ì¢…ë¬´í–‰ì •</a><li><a href=sI.html#events-photo>ì‚¬ì°°ì†Œì‹</a><li><a href=bMG.html#weekend>ë²•íšŒ ë° ê¸°ë„</a><li><a href=tMC.html#g-intro>ë¶ˆêµ êµì‹¤</a></ul><div class=mega-submenu><div class=group><ul><li><a href=yonghasa.html#greeting>ì£¼ììŠ¤ë‹˜ ì¸ì‚¬ë§</a><li><a href=yonghasa.html#heritage>ì„±ë³´ ë¬¸í™”ì¬</a><li><a href=yonghasa.html#visit>ì°¾ì•„ì˜¤ì‹œëŠ” ê¸¸</a></ul></div><div class=group><ul><li><a href=jM.html#notice>ê³µì§€ì‚¬í•­</a><li><a href=jM.html#events>í–‰ì‚¬ì¼ì •</a><li><a href=jM.html#regular>ì •ê¸°ë²•íšŒ ì•ˆë‚´</a></ul></div><div class=group><ul><li><a href=sI.html#events-photo>í–‰ì‚¬ ì‚¬ì§„</a><li><a href=sI.html#gallery>í¬í†  ê°¤ëŸ¬ë¦¬</a></ul></div><div class=group><ul><li><a href=bMG.html#weekend>ì£¼ë§ë²•íšŒ</a><li><a href=bMG.html#prayer>ê¸°ë„ì•ˆë‚´</a><li><a href=bMG.html#memorial>49ì œ ë° ì œì‚¬</a><li><a href=bMG.html#sunday>ì¼ìš”ë²•íšŒ</a></ul></div><div class=group><ul><li><a href=tMC.html#g-intro>ë¶ˆêµ êµì‹¤ ì†Œê°œ</a><li><a href=tMC.html#g-schedule>ê°•ì˜ ì‹œê°„ ì•ˆë‚´</a></ul></div></div></nav></header><section class=page-hero style="--hero:url('assets/img/subheropic/subheropic 002.JPG')"><div class=ph-inner><h1 class=ph-title>ì¢…ë¬´í–‰ì •</h1><nav class=breadcrumbs aria-label=breadcrumb><a href=index.html class=home aria-label=í™ˆ>HOME</a> <span class=sep>â€º</span> <a href=jM.html>ì¢…ë¬´í–‰ì •</a> <span class=sep>â€º</span> <span class=current id=bc-current>ê³µì§€ì‚¬í•­</span></nav><ul class=subnav id=subnav role=tablist><li><a href=#notice data-panel=notice class=active>ê³µì§€ì‚¬í•­</a><li><a href=#events data-panel=events>í–‰ì‚¬ì¼ì •</a><li><a href=#regular data-panel=regular>ì •ê¸°ë²•íšŒ ì•ˆë‚´</a></ul></div></section><main><section class="sheet tab-panel is-active"aria-labelledby=tab-notice id=notice><div class=board-toolbar><select class=select id=sel-notice><option value=all>ì „ì²´<option value=ê³µì§€>ê³µì§€<option value=ì¼ë°˜>ì¼ë°˜</select> <input placeholder="ì œëª© ê²€ìƒ‰"class=input id=q-notice> <button class=btn id=btn-notice>ê²€ìƒ‰</button></div><table class=board id=board-notice><thead><tr><th style=width:80px>ë²ˆí˜¸<th>ì œëª©<th style=width:80px>íŒŒì¼<th style=width:120px>ì‘ì„±ì<th style=width:140px>ì‘ì„±ì¼<th style=width:90px><tbody id=noticeBody></table><div class=pager id=noticePager></div></section><section class="sheet tab-panel"aria-labelledby=tab-schedule id=events><div class=cal-wrap><div class=cal-header><button class="cal-nav prev"aria-label="ì´ì „ ë‹¬">â€¹</button><h2 class=cal-title><span class=cal-year></span>ë…„ <span class=cal-month></span>ì›”</h2><button class="cal-nav next"aria-label="ë‹¤ìŒ ë‹¬">â€º</button></div><div class=cal-grid id=calendar></div><p class=cal-note>Â· ì¼ì •ì€ ì˜ˆì‹œ ë°ì´í„°ì…ë‹ˆë‹¤</div></section><section class="sheet tab-panel"aria-labelledby=tab-regular id=regular><div class=board-toolbar><select class=select id=sel-regular><option value="">ì „ì²´<option value=weekend>ì£¼ë§ë²•íšŒ<option value=prayer>ê¸°ë„ì•ˆë‚´<option value=memorial>49ì œ ë° ì œì‚¬<option value=sunday>ì¼ìš”ë²•íšŒ</select> <input placeholder="ì œëª© ê²€ìƒ‰"class=input id=q-regular> <button class=btn id=btn-regular>ê²€ìƒ‰</button></div><table class=board id=board-regular><thead><tr><th style=width:130px>ë¶„ë¥˜<th>ì œëª©<th style=width:80px>íŒŒì¼<th style=width:120px>ì‘ì„±ì<th style=width:140px>ì‘ì„±ì¼<tbody id=regularTbody></table><div class=pager><button class="btn current">1</button><button class=btn>2</button></div></section><div class="admin-only admin-rail"id=adminRail><span id=adminEmail style=color:#666;font-size:.95rem></span> <button class=btn id=btnToggleEdit>í¸ì§‘ ëª¨ë“œ</button> <button class=btn id=btnAddNotice>+ ê³µì§€</button> <button class=btn id=btnAddEvent>+ ì¼ì •</button> <button class=btn id=btnLogout>ë¡œê·¸ì•„ì›ƒ</button></div><dialog class=dialog id=dlgNotice><form id=frmNotice method=dialog><h3>ìƒˆ ê³µì§€</h3><div class=form-row><label>ì œëª©<input name=title required></label></div><div class=form-row><label>ë§í¬(ì„ íƒ) <input name=fileUrl placeholder=https://...></label></div><div class=form-row><label>ê²Œì‹œì¼(ì„ íƒ) <input name=date type=date></label></div><div class=row style=justify-content:flex-end;margin-top:8px><button class=btn value=cancel>ì·¨ì†Œ</button> <button class="btn btn-primary"value=save>ì €ì¥</button></div></form></dialog><dialog class=dialog id=dlgEvent><form id=frmEvent method=dialog><h3>ìƒˆ ì¼ì •</h3><div class=form-row><label>ì œëª©<input name=title required></label></div><div class=form-row><label>ë‚ ì§œ<input name=date required type=date></label></div><div class=form-row><label>ë¹„ê³ <textarea name=memo placeholder=ì„ íƒ rows=3></textarea></label></div><div class=row style=justify-content:flex-end;margin-top:8px><button class=btn value=cancel>ì·¨ì†Œ</button> <button class="btn btn-primary"value=save>ì €ì¥</button></div></form></dialog><div id=toTop><img alt=TOP src=./assets/icons/top.png style=width:27px;height:27px></div><footer><div class=footer-links><ul><li><a href=index.html>í™ˆ</a><li><a href=yonghasa.html#greeting>ì‚¬ì°°ì†Œê°œ</a><li><a href=admin.html>ê´€ë¦¬ì ë¡œê·¸ì¸</a><li><a href=sI.html#events-photo>ì†Œì‹</a><li><a href=jM.html#notice>ê³µì§€ì‚¬í•­</a><li><a href=yonghasa.html#visit>ì˜¤ì‹œëŠ”ê¸¸</a></ul></div><div class=footer-info><p class=account>ê³„ì¢Œë²ˆí˜¸: ë†í˜‘ 351-1280-7275-33 (ì˜ˆê¸ˆì£¼ : ëŒ€í•œë¶ˆêµ ì¡°ê³„ì¢… ìš©í™”ì‚¬)<p class=name>ëŒ€í•œë¶ˆêµ ì¡°ê³„ì¢… ì²œíƒœì‚° ìš©í™”ì‚¬<p class=address>(ìš°:12531) ê²½ê¸° ì–‘í‰êµ° ì²­ìš´ë©´ í•˜ê³ ë¡ ê¸¸ 38<br>ì¢…ë¬´ì†Œ: 031-773-1148</div><div class=footer-bottom><p class=copyright>Â© 2025 Yonghwasa. All rights reserved.</div></footer><script>// Back to Top Logic
      const toTopBtn = document.getElementById('toTop');
      window.addEventListener('scroll', () => {
        if (window.scrollY > 300) toTopBtn.style.display = 'block';
        else toTopBtn.style.display = 'none';
    });
      toTopBtn.addEventListener('click', () => {
        window.scrollTo({ top: 0, behavior: 'smooth' });
    });

/* íƒ­ ì „í™˜: subnav í´ë¦­ ì‹œ íŒ¨ë„ ìŠ¤ìœ„ì¹­ (ìŠ¤í¬ë¡¤ ì´ë™ X) */
(function(){
  var sub=document.getElementById('subnav');
  if(!sub) return;

  function activatePanel(id){
    // ë§í¬ active
    var links=sub.querySelectorAll('a');
    for(var i=0;i<links.length;i++) links[i].classList.remove('active');
    var current=sub.querySelector('a[data-panel="'+id+'"]');
    if(current) current.classList.add('active');

    // íŒ¨ë„ í‘œì‹œ
    var panels=document.querySelectorAll('.tab-panel');
    for(var j=0;j<panels.length;j++) panels[j].classList.remove('is-active');
    var p=document.getElementById(id);
    if(p) p.classList.add('is-active');

    // ë¹µí¬ëŸ¼ í˜„ì¬ í•­ëª© ë³€ê²½
    var bc=document.getElementById('bc-current');
    if(bc && current) bc.textContent=current.textContent;
  }

  // í´ë¦­ í•¸ë“¤ëŸ¬
  document.addEventListener('click',function(e){
    var t=e.target; while(t&&t.nodeType===3)t=t.parentNode;
    if(!t||!t.closest) return;
    var a=t.closest('a'); if(!a||!a.closest('#subnav')) return;
    var id=a.getAttribute('data-panel'); if(!id) return;
    e.preventDefault();
    activatePanel(id);
  });

  // í•´ì‹œë¡œ ì§ì ‘ ì§„ì… ì‹œ (#regular ë“±)
  var init=location.hash?location.hash.replace('#',''):'notice';
  if(document.getElementById(init)) activatePanel(init);
})();

/* ê°„ë‹¨ ê²€ìƒ‰/í•„í„°: ê³µì§€/í–‰ì‚¬/ì •ê¸° ê³µí†µ í•¨ìˆ˜ */
(function(){
  function bindBoard(ns){
    var q=document.getElementById('q-'+ns);
    var sel=document.getElementById('sel-'+ns);
    var btn=document.getElementById('btn-'+ns);
    var rows=[].slice.call(document.querySelectorAll('#board-'+ns+' tbody tr'));
    function apply(){
      var term=(q&&q.value||'').trim().toLowerCase();
      var tag=sel&&sel.value||'all';
      rows.forEach(function(tr){
        var title=tr.cells[1].innerText.toLowerCase();
        var okTag=(tag==='all')||(tr.getAttribute('data-tag')===tag);
        var okQ=!term||title.indexOf(term)>-1;
        tr.style.display=(okTag&&okQ)?'':'none';
      });
    }
    if(q) q.addEventListener('input',apply);
    if(sel) sel.addEventListener('change',apply);
    if(btn) btn.addEventListener('click',apply);
  }
  ['notice','schedule','regular'].forEach(bindBoard);
})();


/* ===== í–‰ì‚¬ì¼ì • ë‹¬ë ¥: Firestore events ì—°ë™ ===== */
(function(){
  const grid       = document.getElementById('calendar');
  const titleYear  = document.querySelector('.cal-title .cal-year');
  const titleMonth = document.querySelector('.cal-title .cal-month');
  const btnPrev    = document.querySelector('.cal-nav.prev');
  const btnNext    = document.querySelector('.cal-nav.next');
  if(!grid) return;

  let allEvents = [];
  let cur = new Date(); cur.setDate(1);

  const ymd = (d)=>`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,'0')}-${String(d.getDate()).padStart(2,'0')}`;
  const toDate = v => v?.toDate ? v.toDate() : (v ? new Date(v) : null);

  function buildMonthMap(y,m){
    const map = {};
    for(const ev of allEvents){
      const d = toDate(ev.date); if(!d) continue;
      if(d.getFullYear()!==y || d.getMonth()!==m) continue;
      const k = ymd(d);
      (map[k] ||= []).push(ev);
    }
    for(const k in map){
      map[k].sort((a,b)=>{
        const ta=(a.time||''), tb=(b.time||'');
        if(ta&&tb&&ta!==tb) return ta.localeCompare(tb,'ko');
        return (a.title||'').localeCompare(b.title||'','ko');
      });
    }
    return map;
  }

  function render(y,m){
    titleYear.textContent=y; titleMonth.textContent=(m+1);
    const weekdays=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
    let html = weekdays.map(w=>`<div class="cal-cell head">${w}</div>`).join('');
    const first = new Date(y,m,1);
    const startDow = first.getDay();
    const days = new Date(y,m+1,0).getDate();
    const today = new Date(); today.setHours(0,0,0,0);
    const map = buildMonthMap(y,m);

    for(let i=0;i<42;i++){
      const col=i%7, day=i-startDow+1, inMonth=day>=1&&day<=days;
      const cls=['cal-cell','cal-day']; if(!inMonth) cls.push('is-out');
      if(col===0) cls.push('sun'); if(col===6) cls.push('sat');
      if(inMonth){
        const curDate=new Date(y,m,day);
        if(ymd(curDate)===ymd(today)) cls.push('is-today');
      }
      html+=`<div class="${cls.join(' ')}">`;
      html+=`<div class="date">${inMonth?day:'&nbsp;'}</div>`;
      if(inMonth){
        const key = ymd(new Date(y,m,day));
        const list = map[key]||[];
        if(list.length){
          html+=`<ul class="cal-events">`;
          list.slice(0,3).forEach(ev=>{
            const t = ev.time ? (ev.time+' ') : '';
            html+=`<li>${t}${ev.title||''}</li>`;
          });
          if(list.length>3) html+=`<li> â€¦ ì™¸ ${list.length-3}ê±´</li>`;
          html+=`</ul>`;
        }
      }
      html+=`</div>`;
    }
    grid.innerHTML=html;
  }

  function move(diff){
    cur = new Date(cur.getFullYear(), cur.getMonth()+diff, 1);
    render(cur.getFullYear(), cur.getMonth());
  }
  btnPrev?.addEventListener('click', ()=>move(-1));
  btnNext?.addEventListener('click', ()=>move(1));

  // Firestore êµ¬ë…
  db.collection('events').onSnapshot(snap=>{
    const arr=[];
    snap.forEach(doc=>{
      const d=doc.data()||{};
      if(d.seed===true||d.visible===false) return;
      if(!d.date) return;
      arr.push({id:doc.id, ...d});
    });
    allEvents = arr;
    render(cur.getFullYear(), cur.getMonth());
  }, err=>{
    console.error('[events]', err);
    render(cur.getFullYear(), cur.getMonth());
  });

  render(cur.getFullYear(), cur.getMonth());
})();
  var grid = document.getElementById('calendar');


  var titleYear = document.querySelector('.cal-title .cal-year');
  var titleMonth = document.querySelector('.cal-title .cal-month');
  var btnPrev = document.querySelector('.cal-nav.prev');
  var btnNext = document.querySelector('.cal-nav.next');

  var today = new Date();
  var curY = today.getFullYear();
  var curM = today.getMonth(); // 0-11

  function ymd(y,m,d){
    return y + '-' + String(m+1).padStart(2,'0') + '-' + String(d).padStart(2,'0');
  }

  function render(y, m){
    // íƒ€ì´í‹€
    if(titleYear) titleYear.textContent = y;
    if(titleMonth) titleMonth.textContent = (m+1);

    // ìš”ì¼ í—¤ë”
    var weekdays = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
    var html = '';
    for(var i=0;i<7;i++){
      html += '<div class="cal-cell head">'+weekdays[i]+'</div>';
    }

    // ë‚ ì§œ ê³„ì‚°
    var first = new Date(y, m, 1);
    var startDow = first.getDay();              // 0(ì¼)~6(í† )
    var daysInMonth = new Date(y, m+1, 0).getDate();

    // ì´ 6ì£¼(42ì¹¸) ë Œë”
    for(var i=0;i<42;i++){
      var col = i % 7;
      var dayNum = i - startDow + 1;
      var inMonth = (dayNum >= 1 && dayNum <= daysInMonth);

      var cls = ['cal-cell','cal-day'];
      if(!inMonth) cls.push('is-out');
      if(col===0) cls.push('sun');
      if(col===6) cls.push('sat');
      if(inMonth && y===today.getFullYear() && m===today.getMonth() && dayNum===today.getDate()){
        cls.push('is-today');
      }

      html += '<div class="'+cls.join(' ')+'">';
      html += inMonth ? '<div class="date">'+dayNum+'</div>' : '<div class="date">&nbsp;</div>';

      if(inMonth){
        var key = ymd(y,m,dayNum);
        var evts = EVENTS[key] || [];
        if(evts.length){
          html += '<ul class="cal-events">';
          for(var k=0;k<evts.length;k++){
            html += '<li>'+evts[k]+'</li>';
          }
          html += '</ul>';
        }
      }
      html += '</div>';
    }

    grid.innerHTML = html;
  }

  // ì´ˆê¸° ë Œë”
  render(curY, curM);

  // ë„¤ë¹„ê²Œì´ì…˜
  function move(diff){
    var d = new Date(curY, curM + diff, 1);
    curY = d.getFullYear(); curM = d.getMonth();
    render(curY, curM);
  }
  if(btnPrev) btnPrev.addEventListener('click', function(){ move(-1); });
  if(btnNext) btnNext.addEventListener('click', function(){ move(1); });

  // í–‰ì‚¬ì¼ì • íƒ­ìœ¼ë¡œ ì§ì ‘ ì§„ì…(#schedule)ì´ë©´ í™œì„±í™”ë˜ë„ë¡(ì´ë¯¸ íƒ­ ìŠ¤í¬ë¦½íŠ¸ê°€ ì²˜ë¦¬ ì¤‘ì´ê¸´ í•¨)
  if(location.hash.replace('#','')==='schedule'){
    // í•„ìš” ì‹œ ì¶”ê°€ ë™ì‘ ê°€ëŠ¥
  }</script><script>// ë‚ ì§œ í¬ë§· ìœ í‹¸
  function fmtDate(d){
    const y = d.getFullYear();
    const m = String(d.getMonth()+1).padStart(2,'0');
    const day = String(d.getDate()).padStart(2,'0');
    return `${y}-${m}-${day}`;
  }</script><script>(function(){
  var sub=document.getElementById('subnav'); if(!sub) return;
  function activate(id){
    sub.querySelectorAll('a').forEach(a=>a.classList.remove('active'));
    var cur=sub.querySelector('a[data-panel="'+id+'"]'); if(cur) cur.classList.add('active');
    document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('is-active'));
    var panel=document.getElementById(id); if(panel) panel.classList.add('is-active');
    var bc=document.getElementById('bc-current'); if(bc&&cur) bc.textContent=cur.textContent;
    // (ì„ íƒ) í•´ì‹œ ë™ê¸°í™”
    history.replaceState(null, "", "#" + id);
  }
  // â¬‡ï¸ ì´ í•œ ì¤„ì—ì„œ í•´ì‹œë¥¼ ì½ì–´ ì´ˆê¸° íƒ­ì„ ì •í•¨
  var init = location.hash ? location.hash.slice(1) : 'notice';
  if(document.getElementById(init)) activate(init);
})();</script><script>(function(){
  var sub = document.getElementById('subnav'); if(!sub) return;

  function activate(id){
    sub.querySelectorAll('a').forEach(a=>a.classList.remove('active'));
    var cur = sub.querySelector('a[data-panel="'+id+'"]'); if(cur) cur.classList.add('active');

    document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('is-active'));
    var panel = document.getElementById(id); if(panel) panel.classList.add('is-active');

    var bc=document.getElementById('bc-current'); if(bc&&cur) bc.textContent=cur.textContent;
  }

  function activateFromHash(){
    var id = location.hash.slice(1) || 'events';
    if(!document.getElementById(id)) id = 'events';
    activate(id);
  }

  window.addEventListener('hashchange', activateFromHash);     // í•´ì‹œ ë°”ë€” ë•Œë§ˆë‹¤
  document.addEventListener('DOMContentLoaded', activateFromHash); // ì²« ë¡œë“œ
})();</script><script>// ===== ê³µí†µ Firebase ì´ˆê¸°í™” =====
  const DEMO_MODE = false; // ë°ëª¨ ëª¨ë“œë©´ true (ë°±ì—”ë“œ ì—†ì´ ë²„íŠ¼ í…ŒìŠ¤íŠ¸ ê°€ëŠ¥)  
  const ts   = firebase.firestore.FieldValue.serverTimestamp;</script><script>// ëŒ€ì‹œë³´ë“œì™€ ê°™ì€ ì„¤ì •
  
  if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
  

  // ê³µìš© í¬ë§¤í„°
  function fmt(ts){
    try{
      const d = ts?.toDate ? ts.toDate() : (ts ? new Date(ts) : null);
      if(!d) return '-';
      const y=d.getFullYear(), m=('0'+(d.getMonth()+1)).slice(-2), da=('0'+d.getDate()).slice(-2);
      return `${y}.${m}.${da}`;
    }catch(_){ return '-'; }
  }</script><script src=https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js></script><script src=https://www.gstatic.com/firebasejs/10.12.2/firebase-auth-compat.js></script><script src=https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js></script><script>const firebaseConfig = {
    apiKey:"AIzaSyDgOnt9M8Fgc10ppDc2X_HHFJZ3MY7ZcBY",
    authDomain:"yonghwasa-web.firebaseapp.com",
    projectId:"yonghwasa-web",
    storageBucket:"yonghwasa-web.appspot.com",
    appId:"1:853312665810:web:ad06badcb0f23ad42d950b",
    measurementId:"G-JFHHD2E2F2"
  };
  if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
  const db   = firebase.firestore();
  const auth = firebase.auth();

(function(){
  // ëª©ë¡ ì–´ë””ë“ ì§€: .item-link ë¥¼ í´ë¦­í•˜ë©´ view.html?col=...&id=...ìœ¼ë¡œ ì´ë™
  document.addEventListener('click', (e)=>{
    const link = e.target.closest('.item-link');
    if(!link) return;
    const row = link.closest('[data-col][data-id]');
    if(!row) return;
    const col = row.getAttribute('data-col');
    const id  = row.getAttribute('data-id');
    // ìƒì„¸í˜ì´ì§€ë¡œ ì´ë™
    location.href = `view.html?col=${encodeURIComponent(col)}&id=${encodeURIComponent(id)}`;
  });
})();

  // ê³µì§€
db.collection('notices').orderBy('createdAt','desc').get().then(snap=>{
  const html = snap.docs.map(d=>{
    const x = d.data();
    return `
      <div class="notice-item" data-col="notices" data-id="${d.id}">
        <a class="item-link">${x.title || '(ì œëª©ì—†ìŒ)'}</a>
        <span class="date">${(x.createdAt?.toDate?.() ? x.createdAt.toDate().toISOString().slice(0,10) : '')}</span>
      </div>`;
  }).join('');
  document.querySelector('#notice-list').innerHTML = html;
});

// í–‰ì‚¬ì¼ì •
db.collection('events').orderBy('date','desc').get().then(snap=>{
  document.querySelector('#events-list').innerHTML =
    snap.docs.map(d=>{
      const x=d.data(), dt=x.date?.toDate?.();
      return `<div class="event-item" data-col="events" data-id="${d.id}">
                <a class="item-link">${x.title||''}</a>
                <span class="date">${dt? dt.toISOString().slice(0,10): ''}</span>
              </div>`;
    }).join('');
});

// ì •ê¸° ë²•íšŒ
db.collection('regulars').orderBy('createdAt','desc').get().then(snap=>{
  document.querySelector('#regular-list').innerHTML =
    snap.docs.map(d=>{
      const x=d.data();
      return `<div class="regular-item" data-col="regulars" data-id="${d.id}">
                <a class="item-link">${x.title||''}</a>
              </div>`;
    }).join('');
});</script><script>(function(){
  // ===== ìœ í‹¸ =====
  const $ = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const escapeHtml = s => String(s||'').replace(/[&<>"']/g,m=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
  const toDate = v => v?.toDate ? v.toDate() : (v ? new Date(v) : null);
  const ymd = d => {
    const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), da=String(d.getDate()).padStart(2,'0');
    return `${y}-${m}-${da}`;
  };
  const ymdDot = d => {
    const y=d.getFullYear(), m=String(d.getMonth()+1).padStart(2,'0'), da=String(d.getDate()).padStart(2,'0');
    return `${y}.${m}.${da}`;
  };

  // =========================================================
  // 1) ê³µì§€ì‚¬í•­ (collection: notices)
  //    - isPinned(ê³µì§€) ë¨¼ì €, ìµœì‹ ìˆœ
  //    - sel-notice: ì „ì²´/ê³µì§€/ì¼ë°˜
  // =========================================================
  const noticeTB = $('#noticeTbody');
  let noticeAll = [];

  async function loadNotices(){
    const snap = await db.collection('notices').get();
    noticeAll = snap.docs.map(d=>({ id:d.id, ...d.data() }))
      .filter(x=> x.seed!==true && x.visible!==false);
    // ì •ë ¬: ê³µì§€ ìš°ì„  -> createdAt desc
    noticeAll.sort((a,b)=>{
      const ap=a.isPinned?1:0, bp=b.isPinned?1:0;
      if(ap!==bp) return bp-ap;
      const at = toDate(a.createdAt) || toDate(a.updatedAt) || new Date(0);
      const bt = toDate(b.createdAt) || toDate(b.updatedAt) || new Date(0);
      return bt-at;
    });
    renderNotices();
  }

  function renderNotices(){
    if(!noticeTB) return;
    const filter = ($('#sel-notice')?.value||'all');
    const kw = ($('#q-notice')?.value||'').trim().toLowerCase();

    const list = noticeAll.filter(n=>{
      if(filter==='ê³µì§€' && !n.isPinned) return false;
      if(filter==='ì¼ë°˜' && !!n.isPinned) return false;
      if(kw && !(n.title||'').toLowerCase().includes(kw)) return false;
      return true;
    });

    let seq = list.filter(n=>!n.isPinned).length; // ì¼ë°˜ê¸€ ì—­ìˆœ ë²ˆí˜¸
    noticeTB.innerHTML = list.map(n=>{
      const created = toDate(n.createdAt) || new Date();
      const day = toDate(n.date) || created;
      const no = n.isPinned ? 'ê³µì§€' : seq--;
      const badge = n.isPinned ? '<span class="tag">ê³µì§€</span> ' : '';
      const file = (n.fileUrl || (Array.isArray(n.attachments)&&n.attachments.length)) ? 'ğŸ“' : '';
      return `
        <tr data-tag="${n.isPinned?'ê³µì§€':'ì¼ë°˜'}">
          <td>${no}</td>
         <td>${badge}<a href="view.html?col=notices&id=${n.id}">${escapeHtml(n.title||'')}</a></td>
          <td class="file">${file}</td>
          <td>${escapeHtml(n.author||'ì¢…ë¬´ì†Œ')}</td>
          <td>${ymdDot(day)}</td>
          <td></td>
        </tr>`;
    }).join('');
  }

  $('#btn-notice')?.addEventListener('click', renderNotices);
  $('#q-notice')?.addEventListener('keydown', e=>{ if(e.key==='Enter') renderNotices(); });
  $('#sel-notice')?.addEventListener('change', renderNotices);

  // =========================================================
  // 2) í–‰ì‚¬ì¼ì • ë‹¬ë ¥ (collection: events)
  //    - í˜„ì¬ ë³´ì´ëŠ” ë‹¬ ë²”ìœ„ë§Œ ì¿¼ë¦¬í•´ì„œ ì´ë²¤íŠ¸ë¥¼ ì¹ í•¨
  // =========================================================
  const calGrid = $('#calendar');
  const titleYear = document.querySelector('.cal-title .cal-year');
  const titleMonth = document.querySelector('.cal-title .cal-month');
  const btnPrev = document.querySelector('.cal-nav.prev');
  const btnNext = document.querySelector('.cal-nav.next');

  let cur = new Date(); cur.setDate(1);
  let eventsMap = {}; // {'YYYY-MM-DD': ['ì œëª©', ...]}

  async function loadMonthEvents(dFirst){
    const y = dFirst.getFullYear(), m = dFirst.getMonth();
    const start = new Date(y, m, 1, 0,0,0);
    const end   = new Date(y, m+1, 0, 23,59,59);

    const snap = await db.collection('events')
      .where('date','>=', firebase.firestore.Timestamp.fromDate(start))
      .where('date','<=', firebase.firestore.Timestamp.fromDate(end))
      .get();

    eventsMap = {};
    snap.forEach(doc=>{
      const x = doc.data()||{};
      if(x.visible===false || x.seed===true) return;
      const d = toDate(x.date); if(!d) return;
      const key = ymd(d);
      (eventsMap[key] ||= []).push({
      id: doc.id,
      title: (x.title||'(ì œëª©ì—†ìŒ)').trim(),
      time:  (x.time||''),
      place: (x.place||'')
     });
    });
    renderCalendar(dFirst);
  }

  function renderCalendar(dFirst){
    if(!calGrid) return;
    const y = dFirst.getFullYear(), m = dFirst.getMonth();
    titleYear && (titleYear.textContent = y);
    titleMonth && (titleMonth.textContent = m+1);

    const weekdays=['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
    let html = weekdays.map(w=>`<div class="cal-cell head">${w}</div>`).join('');

    const today = new Date(); today.setHours(0,0,0,0);
    const startDow = new Date(y,m,1).getDay();
    const daysInMonth = new Date(y,m+1,0).getDate();

    for(let i=0;i<42;i++){
      const col = i%7;
      const dayNum = i - startDow + 1;
      const inMonth = dayNum>=1 && dayNum<=daysInMonth;
      const classes = ['cal-cell','cal-day'];
      if(!inMonth) classes.push('is-out');
      if(col===0) classes.push('sun');
      if(col===6) classes.push('sat');
      if(inMonth){
        const k = ymd(new Date(y,m,dayNum));
        if(ymd(new Date(y,m,dayNum))===ymd(today)) classes.push('is-today');
      }
      html += `<div class="${classes.join(' ')}">`;
      html += `<div class="date">${inMonth?dayNum:'&nbsp;'}</div>`;
      if(inMonth){
        const key = ymd(new Date(y,m,dayNum));
        const evs = eventsMap[key] || [];
        if(evs.length){
          html += '<ul class="cal-events">';
          evs.forEach(ev => {
            const tt = ev.time ? ev.time + ' ' : '';
            html += `<li>
              <a href="view.html?col=events&id=${ev.id}">
               ${escapeHtml(tt + ev.title)}
            </a>
         </li>`;
       });
          html += '</ul>';
        }
      }
      html += `</div>`;
    }
    calGrid.innerHTML = html;
  }

  btnPrev?.addEventListener('click', ()=>{ cur = new Date(cur.getFullYear(), cur.getMonth()-1, 1); loadMonthEvents(cur); });
  btnNext?.addEventListener('click', ()=>{ cur = new Date(cur.getFullYear(), cur.getMonth()+1, 1); loadMonthEvents(cur); });

  // =========================================================
  // 3) ì •ê¸°ë²•íšŒ ì•ˆë‚´ (collection: regular_posts)
  //    - category: weekend/prayer/memorial/sunday
  // =========================================================
  const regularTB = $('#regularTbody');
  let regularAll = [];

  async function loadRegular(){
    const snap = await db.collection('regular_posts').get();
    regularAll = snap.docs.map(d=>({ id:d.id, ...d.data() }))
      .filter(x=> x.seed!==true && x.visible!==false)
      .sort((a,b)=>{
        const at = toDate(a.createdAt) || toDate(a.updatedAt) || new Date(0);
        const bt = toDate(b.createdAt) || toDate(b.updatedAt) || new Date(0);
        return bt - at;
      });
    renderRegular();
  }

  function catLabel(c){
    return ({weekend:'ì£¼ë§ë²•íšŒ',prayer:'ê¸°ë„ì•ˆë‚´',memorial:'49ì œ ë° ì œì‚¬',sunday:'ì¼ìš”ë²•íšŒ'})[c] || (c||'');
  }

  function renderRegular(){
    if(!regularTB) return;
    const cat = $('#sel-regular')?.value || '';
    const kw = ($('#q-regular')?.value||'').trim().toLowerCase();

    const list = regularAll.filter(r=>{
      if(cat && r.category!==cat) return false;
      if(kw && !(r.title||'').toLowerCase().includes(kw)) return false;
      return true;
    });

    regularTB.innerHTML = list.map(r=>{
      const when = toDate(r.createdAt) || toDate(r.updatedAt) || new Date();
      const file = (r.fileUrl || (Array.isArray(r.attachments)&&r.attachments.length)) ? 'ğŸ“' : '';
      const pin  = r.isPinned ? ' <span class="tag">ê³ ì •</span>' : '';
      return `
        <tr data-tag="${escapeHtml(r.category||'')}">
          <td>${escapeHtml(catLabel(r.category))}${pin}</td>
          <td><a href="view.html?col=regular_posts&id=${r.id}">${escapeHtml(r.title||'')}</a></td>
          <td class="file">${file}</td>
          <td>${escapeHtml(r.author||'ì¢…ë¬´ì†Œ')}</td>
          <td>${ymdDot(when)}</td>
        </tr>`;
    }).join('');
  }

  $('#btn-regular')?.addEventListener('click', renderRegular);
  $('#q-regular')?.addEventListener('keydown', e=>{ if(e.key==='Enter') renderRegular(); });
  $('#sel-regular')?.addEventListener('change', renderRegular);

  // ===== ìµœì´ˆ ë¡œë“œ =====
  Promise.all([loadNotices(), loadMonthEvents(cur), loadRegular()]);
})();</script><script>// ===== ê³µì§€ì‚¬í•­: ì‹¤ì‹œê°„ ë¡œë“œ + ê²€ìƒ‰ + í˜ì´ì§• =====
(function(){
  const PAGE_SIZE = 16;

  const tbody   = document.getElementById('noticeBody');
  const pagerEl = document.getElementById('noticePager');
  const selEl   = document.getElementById('sel-notice'); // ì „ì²´/ê³µì§€/ì¼ë°˜
  const qEl     = document.getElementById('q-notice');
  const btnEl   = document.getElementById('btn-notice');

  let all = [];        // Firestoreì—ì„œ ë°›ì•„ì˜¨ ì „ì²´
  let filtered = [];   // ê²€ìƒ‰/í•„í„° ì ìš©ëœ ê²°ê³¼
  let page = 1;        // í˜„ì¬ í˜ì´ì§€(1-base)

  // ë‚ ì§œ í¬ë§· (YYYY.MM.DD)
  function fmtDate(d){
    try{
      if (d?.toDate) d = d.toDate();
      if (!(d instanceof Date)) d = new Date(d);
      const y = d.getFullYear();
      const m = String(d.getMonth()+1).padStart(2,'0');
      const da= String(d.getDate()).padStart(2,'0');
      return `${y}.${m}.${da}`;
    }catch(_){ return '-'; }
  }

  // í–‰ ë Œë”
  function renderRows(slice){
    const rows = slice.map((d, idx)=>{
      const hasFile = !!(d.fileUrl || (Array.isArray(d.attachments) && d.attachments.length));
      const tag = d.type || 'ì¼ë°˜';
      // ë²ˆí˜¸: í˜ì´ì§€ ë‚´ 1~ / í•„ìš”í•˜ë©´ ì „ì²´ ë„˜ë²„ë¡œ ë°”ê¾¸ë ¤ë©´ ( (page-1)*PAGE_SIZE + idx + 1 )
      const num = (idx + 1) + (page-1)*PAGE_SIZE;

      const dateForDisplay = d.date?.toDate ? d.date.toDate()
                           : (d.createdAt?.toDate ? d.createdAt.toDate() : new Date());

      return `
        <tr data-tag="${tag}">
          <td>${num}</td>
          <td>${tag==='ê³µì§€'?'<span class="tag">ê³µì§€</span>':''}
          <a href="view.html?col=notices&id=${d.id}">
            ${d.title||''}
          </a>
        </td>
          <td class="file">${hasFile ? 'ğŸ“' : ''}</td>
          <td>ì¢…ë¬´ì†Œ</td>
          <td>${fmtDate(dateForDisplay)}</td>
          <td></td>
        </tr>`;
    }).join('');

    tbody.innerHTML = rows || `<tr><td colspan="6" style="text-align:center;color:#777">ê²Œì‹œë¬¼ì´ ì—†ìŠµë‹ˆë‹¤.</td></tr>`;
  }

  // í˜ì´ì € ë Œë”
  function renderPager(){
    const totalPages = Math.max(1, Math.ceil(filtered.length / PAGE_SIZE));
    if (totalPages <= 1){ pagerEl.innerHTML = ''; return; }

    let html = '';
    html += `<button class="btn" data-page="prev" ${page<=1?'disabled':''}>ì´ì „</button>`;

    // í˜ì´ì§€ ë²ˆí˜¸ (ë§ì•„ì§ˆ ìˆ˜ ìˆìœ¼ë‹ˆ ì•Â·ë’¤ 2ê°œ + í˜„ì¬ ì£¼ë³€ë§Œ í‘œì‹œ)
    const windowSize = 2;
    const start = Math.max(1, page - windowSize);
    const end   = Math.min(totalPages, page + windowSize);

    if (start > 1){
      html += `<button class="btn" data-page="1">1</button>`;
      if (start > 2) html += `<span style="padding:.4rem .5rem;color:#999">â€¦</span>`;
    }

    for (let p=start; p<=end; p++){
      html += `<button class="btn ${p===page?'current':''}" data-page="${p}">${p}</button>`;
    }

    if (end < totalPages){
      if (end < totalPages-1) html += `<span style="padding:.4rem .5rem;color:#999">â€¦</span>`;
      html += `<button class="btn" data-page="${totalPages}">${totalPages}</button>`;
    }

    html += `<button class="btn" data-page="next" ${page>=totalPages?'disabled':''}>ë‹¤ìŒ</button>`;
    pagerEl.innerHTML = html;
  }

  // í˜„ì¬ page í‘œì‹œ
  function renderPage(){
    const start = (page-1) * PAGE_SIZE;
    const slice = filtered.slice(start, start + PAGE_SIZE);
    renderRows(slice);
    renderPager();
  }

  // ê²€ìƒ‰/í•„í„° ì ìš©
  function applyFilter(){
    const term = (qEl?.value || '').trim().toLowerCase();
    const tag  = selEl?.value || 'all';
    filtered = all.filter(d=>{
      if (tag !== 'all' && (d.type||'ì¼ë°˜') !== tag) return false;
      if (term && !(d.title||'').toLowerCase().includes(term)) return false;
      return true;
    });
    page = 1; // ê²€ìƒ‰/í•„í„° ë°”ê¾¸ë©´ 1í˜ì´ì§€ë¡œ
    renderPage();
  }

  // í˜ì´ì € í´ë¦­
  pagerEl.addEventListener('click', (e)=>{
    const b = e.target.closest('button[data-page]');
    if(!b) return;
    const val = b.getAttribute('data-page');
    const totalPages = Math.max(1, Math.ceil(filtered.length / PAGE_SIZE));
    if (val === 'prev') page = Math.max(1, page-1);
    else if (val === 'next') page = Math.min(totalPages, page+1);
    else page = parseInt(val,10) || 1;
    renderPage();
  });

  // ê²€ìƒ‰ ë°”ì¸ë”©
  btnEl?.addEventListener('click', applyFilter);
  qEl?.addEventListener('keydown', (e)=>{ if(e.key==='Enter') applyFilter(); });
  selEl?.addEventListener('change', applyFilter);

  // Firestore êµ¬ë… (ìµœì‹ ìˆœ)
  db.collection('notices').orderBy('createdAt','desc').onSnapshot((snap)=>{
    const list = [];
    snap.forEach(doc=>{
      const d = doc.data() || {};
      if (d.seed === true || d.visible === false) return; // ì‹œë“œ/ë¹„ê³µê°œ ì œì™¸
      list.push({ id: doc.id, ...d });
    });
    all = list;
    applyFilter(); // ìµœì´ˆ ë Œë” + ì‹¤ì‹œê°„ ë°˜ì˜
  }, (err)=>{
    console.error('[notices onSnapshot]', err);
    tbody.innerHTML = `<tr><td colspan="6" style="color:#c00">ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.</td></tr>`;
    pagerEl.innerHTML = '';
  });

})();</script><script src=admin-inline.js></script><link href=admin-inline.css rel=stylesheet>
