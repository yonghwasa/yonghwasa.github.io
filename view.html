<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>ìƒì„¸ë³´ê¸°</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<style>
  :root{--brand:#B9A26A;--ink:#2c3e50;}
  *{box-sizing:border-box}
  body{font-family:'Noto Sans KR',system-ui,-apple-system,Segoe UI,Roboto,Arial; background:#f6f6f6; color:#333; margin:0}
  .wrap{max-width:1100px; margin:32px auto; padding:0 16px}
  .card{background:#fff; border-radius:12px; box-shadow:0 8px 22px rgba(0,0,0,.06); overflow:hidden}
  .head{padding:18px 22px; background:#f7f5ef; border-left:6px solid var(--brand); font-weight:700; font-size:22px}
  .meta{padding:12px 22px; color:#666; border-bottom:1px solid #eee; display:flex; gap:12px; flex-wrap:wrap}
  .meta span{white-space:nowrap}
  .body{padding:24px 22px; line-height:1.9}
  .body img{
  display:block;
  width:min(980px, 100%);   /* í™”ë©´ì´ ë„“ìœ¼ë©´ ìµœëŒ€ 980px, ì¢ìœ¼ë©´ 100% */
  height:auto;
  margin:14px auto;         /* ì¤‘ì•™ ì •ë ¬ + ì—¬ë°± */
  border-radius:10px;
  } 
  .attach{padding:16px 22px; background:#fafafa; border-top:1px dashed #e5e5e5}
  .attach h4{margin:0 0 8px 0; color:#444; font-size:15px}
  .attach a{display:inline-flex; align-items:center; gap:8px; padding:10px 12px; background:#fff; border:1px solid #e8e8e8; border-radius:8px; text-decoration:none; color:#333}
  .photo-hero{width:100%; max-height:680px; object-fit:cover}
  .nav{display:flex; justify-content:space-between; padding:18px 0}
  .btn{display:inline-block; padding:10px 16px; border-radius:10px; border:1px solid #ddd; background:#fff; color:#333; text-decoration:none}
  .btn.primary{background:var(--brand); color:#fff; border-color:var(--brand)}
  .grid-photos{display:grid; grid-template-columns:repeat(auto-fill,minmax(220px,1fr)); gap:12px; margin-top:12px}
  .grid-photos img{width:100%; height:200px; object-fit:cover; border-radius:8px}

  .page-hero{position:relative;min-height:260px;background:#eee}
.ph-inner{max-width:1200px;margin:0 auto;height:100%;display:flex;flex-direction:column;justify-content:center;padding:1.5rem}
.ph-title{font-size:2rem;font-weight:800;margin:0 0 .5rem}
.breadcrumbs{display:flex;gap:.5rem;color:#666}
.breadcrumbs .sep{opacity:.6}
.subnav{display:flex;gap:1rem;list-style:none;margin-top:.75rem;padding:0}
.subnav a{padding:.35rem .6rem;border-radius:999px}
.subnav a.active{background:rgba(0,0,0,.08)}

  /* ë§í¬ê°€ ë³´ë¼ìƒ‰ìœ¼ë¡œ ë³´ì´ì§€ ì•Šë„ë¡ */
  a,a:visited{color:inherit;text-decoration:none}

  /* Reset & Base */
    * { margin:0; padding:0; box-sizing:border-box; }
    html, body { min-width: 1280px; overflow-x: auto; }
    body { font-family:'Noto Sans KR',sans-serif; background:#fafafa; color:#333; line-height:1.6; }
    img, video { max-width:100%; display:block; }
    a { text-decoration:none; color:inherit; }
    #wrapper { width: clamp(1280px, 100%, 1920px); min-width: 1280px; max-width: 1440px;
               height: clamp(860px, 100%, 1080px ); min-height: 740px; max-height: 1080px; 
               margin: 0 auto;}

    /* Header */
    .header-top { background:#fff; padding:0.75rem 2rem;
              display:flex; align-items:center; justify-content:center;
              gap:0.5rem; font-size: 1rem; color: #333;
              border-bottom: 1px solid #eaeaea;
            }
    .header-top img{ justify-content: center; width: 250px; height: 105px;}
    .header-top .divider {color: #ccc; margin: 0 0.75rem;}
    .header-top .temple-name {font-weight: 700;}
    :root { --menu-width: 1200px; --menu-gap: 10rem; }
    nav.main-nav {
      background:#fff; position: relative;
      padding:0.5rem 2rem; overflow: visible;
    }
    nav.main-nav > ul { display:flex; justify-content: center; flex-wrap: nowrap;
                        list-style:none; gap: 10rem; white-space: nowrap;
                        font-weight: 500; max-width: 1200px; margin: 0 auto;
                        position: relative;}
    nav.main-nav ul li { position:relative; padding: 0; }
    nav.main-nav > ul > li:not(:last-child)::after{
      content: "|"; font-size: larger;
      position: absolute;
      right: -5rem;
      color: #333;
    }
    nav.main-nav ul li > a{
      color: #333; white-space: nowrap;
      padding: 1rem;
      transition: color 0.2s;
      font-size: larger;
    }
    nav.main-nav ul li > a:hover{
      color: #B9A26A;
    }
    nav.main-nav > ul.menu{
  max-width: var(--menu-width);
  margin: 0 auto;
  gap: var(--menu-gap);                  
}
nav.main-nav > ul.menu > li + li::after{
  right: calc(-0.5 * var(--menu-gap));   
}
nav.main-nav .mega-submenu{
  left: 50%;
  transform: translateX(-50%);
  width: var(--menu-width);
  max-width: var(--menu-width);          
}


    nav.main-nav .mega-submenu { display: grid; grid-template-columns: repeat(5, max-content);  column-gap: 8rem;                             
                                 position: absolute; top: 100%; left: 0; justify-content: center;
                                 width: 100%; max-width: 1920px; padding: 2rem;
                                 background: #fff; box-shadow: 0 2px 8px rgba(0,0,0,0.1); box-sizing: border-box;
                                 opacity: 0; pointer-events: none; transform: translateY(-10px);
                                 transition: opacity 0.3s ease, transform 0.3s ease-out; z-index: 50;}

    nav.main-nav:hover .mega-submenu { opacity: 1; pointer-events: auto; transform: translateY(0); }
    nav.main-nav .mega-submenu .group { text-align: left; padding: 0 0.25rem; box-sizing: border-box; }
    nav.main-nav .mega-submenu .group ul { list-style: none; padding: 0; margin: 0; }
    nav.main-nav .mega-submenu .group ul li + li { margin-top: 0.35rem;  padding-left: 0; }
    nav.main-nav .mega-submenu .group a { color: #333; text-decoration: none; transition: color 0.2s; }
    nav.main-nav .mega-submenu .group a:hover { color: #B9A26A; }
    nav.main-nav:hover .mega-submenu { opacity: 1; pointer-events: auto; transform: translateY(0); }
    
    @media (max-width: 1360px){
  nav.main-nav .mega-submenu{ grid-template-columns: repeat(5, 1fr); gap: 3.5rem; }
    }

  /* ===== Hero (ì¢…ë¬´í–‰ì •ê³¼ ë™ì¼) ===== */
:root{
  --menu-width: 1200px; /* íˆì–´ë¡œ ë‚´ë¶€ ì»¨í…Œì´ë„ˆ í­ */
}

/* ë°°ê²½ ì´ë¯¸ì§€ ì„¹ì…˜ */
.page-hero{
  position: relative;
  min-height: 360px;
  background-image: var(--hero, url('/Users/junjun/Downloads/Project/subheropic/5-5 .JPG'));
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
}
.page-hero::before{
  content:"";
  position:absolute; inset:0;
  /* ìƒë‹¨ì€ ì˜…ê²Œ, í•˜ë‹¨ì€ ì§„í•˜ê²Œ (ì›ë³¸ê³¼ ë™ì¼í•œ ê°ë„) */
  background: linear-gradient(180deg, rgba(0,0,0,.08) 35%, rgba(0,0,0,.5) 100%);
}

/* íˆì–´ë¡œ ë‚´ë¶€ ì •ë ¬ */
.ph-inner{
  position:absolute; inset:0;
  left:50%; transform:translateX(-50%);
  max-width: var(--menu-width);
  padding: 2rem 1rem;
  color:#fff; text-align:center;

  display:flex; flex-direction:column;
  justify-content:center; align-items:center;
}

/* íƒ€ì´í‹€ */
.ph-title{
  font-size: clamp(1.8rem, 2.4vw + 1rem, 3rem);
  font-weight: 800;
  letter-spacing: .03em;
  text-shadow: 0 3px 12px rgba(0,0,0,.35);
  margin-bottom: .8rem;
}

/* ë¹µí¬ëŸ¼ */
.breadcrumbs{
  display:flex; align-items:center; gap:.5rem;
  font-size:.95rem; opacity:.95; margin-bottom:.9rem;
}
.breadcrumbs a{ color:#fff; }
.breadcrumbs .sep{ opacity:.6; }

/* ì„œë¸Œ íƒ­ */
.subnav{
  position:absolute; bottom:14px; left:50%; transform:translateX(-50%);
  display:flex; flex-wrap:wrap; justify-content:center; align-items:center;
  gap:1rem 2rem; max-width: var(--menu-width);
  padding:.25rem .75rem;
}
.subnav li{ list-style:none; position:relative; }
.subnav li+li::before{
  content:"â€¢"; position:absolute; left:-1.2rem; top:50%;
  transform:translateY(-50%); color: rgba(255,255,255,.65);
}
.subnav a{
  color:#fff; padding:.35rem .6rem; border-radius:999px;
  transition:.2s ease; white-space:nowrap;
}
.subnav a:hover{ background: rgba(255,255,255,.12); }
.subnav a.active{
  background: rgba(0,0,0,.28);
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.35);
}

/* ë°˜ì‘í˜•(ì›ë³¸ê³¼ ë™ì¼ ê¸°ì¤€) */
@media (max-width: 1024px){
  .page-hero{ min-height:300px; }
  .subnav{ gap:.8rem 1.2rem; }
  .subnav li+li::before{ left:-1rem; }
}

.page-hero{
  position:relative; min-height:360px;
  background-image: var(--hero);   /* â† ì´ ë³€ìˆ˜ì— JSê°€ ë¶„ë¥˜ë³„ ì´ë¯¸ì§€ë¥¼ ë„£ì–´ìš” */
  background-size:cover; background-position:center;
}
.page-hero::before{
  content:""; position:absolute; inset:0;
  background:linear-gradient(180deg,rgba(0,0,0,.08) 35%, rgba(0,0,0,.5) 100%);
}



  /* Footer Links Bar*/
    .footer-links{
      background: #B9A26A;
      padding: 0.75rem 1rem;
    }
    .footer-links ul{
      display: flex;
      justify-content: flex-start;
      gap: 0.65rem;
      padding-left: 0.75rem;
      list-style: none;
      font-size: 0.95rem;
    }
    .footer-links ul li{
      position: relative;
    }
    .footer-links ul li:not(:last-child)::after{
      content: "/";
      margin: 0 0.75rem;
      color: rgba(255,255,255,0.7);
    }
    .footer-links ul li a{
      color: #fff;
      transition:color 0.2s;
    }
    .footer-links ul li a:hover{
      color: #333;
    }

    /*Footer Info */
    .footer-info{
      background: #333;
      color: #fff;
      text-align: start;
      padding: 1.5rem 1.5rem;
      line-height: 1.4;
    }
    .footer-info .account{
      color: #efc964;
      font-weight: 600;
      margin-bottom: 0.75rem;
    }
    .footer-info .address{
      font-size: 0.9rem;
      opacity: 0.85;
    }
    .footer-info .name{
      text-align: right;
      padding-right: 4rem;
      font-size: larger;
      font-style: italic;
      opacity: 0.6;
    }

    /*Footer Bottom */
    .footer-bottom{
      background: #222;
      color: #ccc;
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 0.75rem 1rem;
      font-size: 0.85rem;
    }
    

    /* Back to Top */
    #toTop { position:fixed; bottom:20px; right:20px;
             background:#fff; color:#222; padding:0;
             border-radius:50%; cursor:pointer; display:none;
             box-shadow:0 2px 6px rgba(0,0,0,0.2); width: 32px; height: 32px;
             display: flex; align-items: center; justify-content: center; }

   /* ------- ìƒì„¸í˜ì´ì§€ ì´ë¯¸ì§€ ê³µí†µ(ì•ˆ ì˜ë¦¬ë©´ì„œ ê°™ì€ í¬ê¸°) ------- */
:root{
  /* ì›í•˜ëŠ” ë°•ìŠ¤ í­ê³¼ ë¹„ìœ¨ë§Œ ë°”ê¾¸ë©´ í•œ ë²ˆì— ì¡°ì •ë©ë‹ˆë‹¤ */
  --detail-w: 720px;     /* ì‚¬ì§„ í‘œì‹œ í­(ë°ìŠ¤í¬í†± ê¸°ì¤€ ìµœëŒ€í­) */
  --detail-ratio: 4/3;   /* 16/9, 3/2, 1/1 ë“±ìœ¼ë¡œ ì·¨í–¥ ë³€ê²½ ê°€ëŠ¥ */
}

/* 1) ì²« ë²ˆì§¸ í° ì´ë¯¸ì§€(.photo-hero)ë„ ê·¸ë¦¬ë“œ ì´ë¯¸ì§€ì™€ ë™ì¼ ë°•ìŠ¤ í¬ê¸° */
.body img.photo-hero{
  width: min(var(--detail-w), 100%);
  aspect-ratio: var(--detail-ratio);
  height: auto;                 /* aspect-ratioê°€ ë†’ì´ë¥¼ ë§Œë“¤ì–´ ì¤Œ */
  object-fit: contain !important;/* ì ˆëŒ€ ìë¥´ì§€ ì•ŠìŒ */
  background: #fff;             /* ë ˆí„°ë°•ìŠ¤ ì˜ì—­(ë‚¨ëŠ” ì—¬ë°±) */
  border-radius: 12px;
  margin: 14px auto;
  /* ê¸°ì¡´ì˜ í° ë†’ì´ ì œí•œ/ìë¥´ê¸° ì˜µì…˜ì„ ë®ì–´ì“°ê¸° */
  max-height: none !important;
}

/* 2) ë‚˜ë¨¸ì§€ ì´ë¯¸ì§€ë“¤ë„ ë™ì¼ ë°•ìŠ¤ í¬ê¸°ë¡œ ë§ì¶¤ */
.body .grid-photos img{
  width: min(var(--detail-w), 100%);
  aspect-ratio: var(--detail-ratio);
  height: auto;
  object-fit: contain;
  background: #fff;
  border-radius: 10px;
  margin: 14px auto;            /* ê°€ìš´ë° ì •ë ¬ */
}

/* 3) ê·¸ë¦¬ë“œê°€ ì¢ì•„ì„œ ì¹´ë“œê°€ ì°Œê·¸ëŸ¬ì§€ì§€ ì•Šê²Œ(ì„ íƒ) */
.body .grid-photos{
  display: grid;
  grid-template-columns: 1fr;    /* í•œ ì¤„ì— í•˜ë‚˜ì”©(ì›í•˜ë©´ ì£¼ì„ ì²˜ë¦¬) */
  gap: 12px;
}



</style>
</head>
<body>
<!-- Header -->
  <div class="wrapper">
    <header>
      <div class="header-top">
         <a href="try.html"> 
          <img src="/Users/junjun/Downloads/Project/ì œëª©ì„-ì…ë ¥í•´ì£¼ì„¸ìš”_-001.png" alt="ì²œíƒœì‚° ìš©í™”ì‚¬ ë§ˆí¬">  
          <span class="divider"></span>
          <span class="temple-name"></span>
         </a>
      </div>
      <nav class="main-nav">
        <ul class="menu">
          <li><a href="yonghasa.html#greeting">ì²œíƒœì‚° ìš©í™”ì‚¬</a></li>
          <li><a href="jM.html#notice">ì¢…ë¬´í–‰ì •</a></li>
          <li><a href="sI.html#events-photo">ì‚¬ì°°ì†Œì‹</a></li>
          <li><a href="bMG.html#weekend">ë²•íšŒ ë° ê¸°ë„</a></li>
          <li><a href="tMC.html#g-intro">ë¶ˆêµ êµì‹¤</a></li>
        </ul>
        <div class="mega-submenu">
          <div class="group">
            <ul>
              <li><a href="yonghasa.html#greeting">ì£¼ììŠ¤ë‹˜ ì¸ì‚¬ë§</a></li>
              <li><a href="yonghasa.html#heritage">ì„±ë³´ ë¬¸í™”ì¬</a></li>
              <li><a href="yonghasa.html#visit">ì°¾ì•„ì˜¤ì‹œëŠ” ê¸¸</a></li>
            </ul>
          </div>
          <div class="group">
            <ul>
              <li><a href="jM.html#notice">ê³µì§€ì‚¬í•­</a></li>
              <li><a href="jM.html#events">í–‰ì‚¬ì¼ì •</a></li>
              <li><a href="jM.html#regular">ì •ê¸°ë²•íšŒ ì•ˆë‚´</a></li>
            </ul>
          </div>
          <div class="group">
            <ul>
              <li><a href="sI.html#events-photo">í–‰ì‚¬ ì‚¬ì§„</a></li>
              <li><a href="sI.html#gallery">í¬í†  ê°¤ëŸ¬ë¦¬</a></li>
            </ul>
          </div>
          <div class="group">
            <ul>
              <li><a href="bMG.html#weekend">ì£¼ë§ë²•íšŒ</a></li>
              <li><a href="bMG.html#prayer">ê¸°ë„ì•ˆë‚´</a></li>
              <li><a href="bMG.html#memorial">49ì œ ë° ì œì‚¬</a></li>
              <li><a href="bMG.html#sunday">ì¼ìš”ë²•íšŒ</a></li>
            </ul>
          </div>
          <div class="group">
            <ul>
              <li><a href="tMC.html#g-intro">ë¶ˆêµ êµì‹¤ ì†Œê°œ</a></li>
              <li><a href="tMC.html#g-schedule">ê°•ì˜ ì‹œê°„ ì•ˆë‚´</a></li>
            </ul>
          </div>
        </div>
      </nav>
    </header>

  <!-- íˆì–´ë¡œ -->
<section id="hero" class="page-hero">
  <div class="ph-inner">
    <h1 id="heroTitle" class="ph-title">ìƒì„¸</h1>
    <nav id="breadcrumbs" class="breadcrumbs"></nav>
    <ul id="subnav" class="subnav"></ul>
  </div>
</section>






<div class="wrap">
  <div class="card">
    <div id="title" class="head">ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘â€¦</div>
    <div id="meta" class="meta"></div>
    <div id="content" class="body"></div>
    <div id="attach" class="attach" style="display:none"></div>
  </div>
  <div class="nav">
    <a id="prevLink" class="btn" href="#" style="visibility:hidden">â—€ ì´ì „ê¸€</a>
    <a id="back" class="btn" href="javascript:history.back()">ëª©ë¡ë³´ê¸°</a>
    <a id="nextLink" class="btn" href="#" style="visibility:hidden">ë‹¤ìŒê¸€ â–¶</a>
  </div>
</div>

  <!-- Back to Top Button -->
    <div id="toTop">
      <img src="/Users/junjun/Downloads/Project/ì•„ì´ì½˜/ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”_-010.png" alt="TOP" style="width: 27px; height: 27px;">
    
    </div>

  <!-- Footer -->
    <footer>
      <div class="footer-links">
        <ul>
        <li><a href="try.html">í™ˆ</a></li>
        <li><a href="yonghasa.html#greeting">ì‚¬ì°°ì†Œê°œ</a></li>
        <li><a href="admin.html">ê´€ë¦¬ì ë¡œê·¸ì¸</a></li>
        <li><a href="sI.html#events-photo">ì†Œì‹</a></li>
        <li><a href="jM.html#notice">ê³µì§€ì‚¬í•­</a></li>
        <li><a href="yonghasa.html#visit">ì˜¤ì‹œëŠ”ê¸¸</a></li>
        </ul>
      </div>
      <div class="footer-info">
        <p class="account">ê³„ì¢Œë²ˆí˜¸: ê¸°ì—… 000000000 (ì˜ˆê¸ˆì£¼ : ìš©í™”ì‚¬)</p>
        <p class="name">ì²œíƒœì‚° ìš©í™”ì‚¬</p>
        <p class="address">
          (ìš°:12531) ê²½ê¸° ì–‘í‰êµ° ì²­ìš´ë©´ í•˜ê³ ë¡ ê¸¸ 38<br>
          ì¢…ë¬´ì†Œ: 031-773-1148
        </p>

      </div>
     <div class="footer-bottom">
       <p class="copyright">Â© 2025 Yonghwasa. All rights reserved.</p>
      
      </div>
    </footer>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore-compat.js"></script>

<script>
/* ===== Firebase config ===== */
const firebaseConfig = {
  apiKey:"AIzaSyBFh2Z7DKG9a8Q0GJk065FrN3NXnOrVFr4",
  authDomain:"yonghwasa-web.firebaseapp.com",
  projectId:"yonghwasa-web",
  storageBucket:"yonghwasa-web.appspot.com",
  appId:"1:853312665810:web:ad06badcb0f23ad42d950b",
  measurementId:"G-JFHHD2E2F2"
};
if(!firebase.apps.length) firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();

/* ===== ìœ í‹¸ ===== */
const $ = s => document.querySelector(s);
const esc = s => String(s??'').replace(/[&<>"']/g,m=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;' }[m]));
const toDate = v => v?.toDate ? v.toDate() : (v ? new Date(v) : null);
const pad = n => String(n).padStart(2,'0');
const ymd = d => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
const qs = new URLSearchParams(location.search);

/* ===== ì¿¼ë¦¬ ===== */
const RAW_COL = qs.get('col') || '';
const ID      = qs.get('id')  || '';

/* ë³„ì¹­ â†’ ì‹¤ì œ ì»¬ë ‰ì…˜ */
const ALIAS = {
  notices: 'notices',
  notice_posts: 'notices',
  events: 'events',
  event_posts: 'events',
  regulars: 'regular_posts',      // â˜… ì •ê¸°ë²•íšŒ í‘œì¤€í™”
  regular_posts: 'regular_posts',
  photos_events: 'photos_events',
  photos_gallery: 'photos_gallery'
};
const COL = ALIAS[RAW_COL] || RAW_COL;

/* ë¼ë²¨/íƒ€ì´í‹€ */
const COLLECTION_TITLE = {
  notices: 'ê³µì§€ì‚¬í•­',
  events: 'í–‰ì‚¬ì¼ì •',
  regular_posts: 'ì •ê¸° ë²•íšŒ ì•ˆë‚´',
  photos_gallery: 'í¬í†  ê°¤ëŸ¬ë¦¬',
  photos_events: 'í–‰ì‚¬ ì‚¬ì§„'
};
const LABEL = {
  notices: 'ê³µì§€ì‚¬í•­',
  events: 'í–‰ì‚¬ì¼ì •',
  regular_posts: 'ì •ê¸°ë²•íšŒ ì•ˆë‚´',
  photos_events: 'í–‰ì‚¬ ì‚¬ì§„',
  photos_gallery: 'í¬í†  ê°¤ëŸ¬ë¦¬'
};
const IS_JM = ['notices','events','regular_posts'].includes(COL);

/* íˆì–´ë¡œ ë Œë” */
function renderHero(){
  const hero = $('#hero'), t=$('#heroTitle'), bc=$('#breadcrumbs'), sn=$('#subnav');
  if(!hero||!t||!bc||!sn) return;
  const BG = {
    jm:   "url('/Users/junjun/Downloads/Project/subheropic/5-5 .JPG')",
    news: "url('/Users/junjun/Downloads/Project/subheropic/x-16 .JPG')"
  };
  hero.style.setProperty('--hero', IS_JM ? BG.jm : BG.news);

  if (IS_JM){
    t.textContent = 'ì¢…ë¬´í–‰ì •';
    bc.innerHTML =
      `<a href="try.html">HOME</a><span class="sep">â€º</span>
       <a href="jM.html">ì¢…ë¬´í–‰ì •</a><span class="sep">â€º</span>
       <span class="current">${LABEL[COL]}</span>`;
    sn.innerHTML =
      `<li><a href="jM.html#notice"  class="${COL==='notices'?'active':''}">ê³µì§€ì‚¬í•­</a></li>
       <li><a href="jM.html#events"  class="${COL==='events'?'active':''}">í–‰ì‚¬ì¼ì •</a></li>
       <li><a href="jM.html#regular" class="${COL==='regular_posts'?'active':''}">ì •ê¸°ë²•íšŒ ì•ˆë‚´</a></li>`;
  } else {
    t.textContent = 'ì‚¬ì°° ì†Œì‹';
    bc.innerHTML =
      `<a href="try.html">HOME</a><span class="sep">â€º</span>
       <a href="sI.html">ì‚¬ì°° ì†Œì‹</a><span class="sep">â€º</span>
       <span class="current">${LABEL[COL]}</span>`;
    sn.innerHTML =
      `<li><a href="sI.html#events-photo" class="${COL==='photos_events'?'active':''}">í–‰ì‚¬ ì‚¬ì§„</a></li>
       <li><a href="sI.html#gallery"      class="${COL==='photos_gallery'?'active':''}">í¬í†  ê°¤ëŸ¬ë¦¬</a></li>`;
  }
}

/* ===== ìƒì„¸ ë¡œë”© ===== */
async function load(){
  try{
    if(!COL || !ID){ $('#title').textContent='ì˜ëª»ëœ ì ‘ê·¼ì…ë‹ˆë‹¤.'; return; }

    const docRef = db.collection(COL).doc(ID);
    const snap   = await docRef.get();
    if(!snap.exists){ $('#title').textContent='ì‚­ì œë˜ì—ˆê±°ë‚˜ ì—†ëŠ” ê¸€ì…ë‹ˆë‹¤.'; return; }

    const d = snap.data() || {};
    const title   = d.title || '(ì œëª©ì—†ìŒ)';
    const author  = d.author || d.writer || 'ê´€ë¦¬ì';
    const created = toDate(d.createdAt) || toDate(d.date) || new Date();
    const views   = d.views|0;

    // ì œëª©/ë©”íƒ€
    $('#title').textContent = title;
    $('#meta').innerHTML =
      `<span>ë¶„ë¥˜ : ${COLLECTION_TITLE[COL]||COL}</span>`+
      `<span>ì‘ì„±ì : ${esc(author)}</span>`+
      `<span>ë“±ë¡ì¼ : ${ymd(created)}</span>`+
      `<span>ì¡°íšŒìˆ˜ : ${views}</span>`;

    // ë³¸ë¬¸
    const contentEl = $('#content');

    // í…ìŠ¤íŠ¸í˜•(ê³µì§€/ì¼ì •/ì •ê¸°ë²•íšŒ)  â˜… regular_posts ë¡œ ì²´í¬
    if (COL==='notices' || COL==='events' || COL==='regular_posts') {
      const rawHtml = d.contentHtml || d.bodyHtml || '';
      const rawText = d.content || d.body || d.memo || d.description || '';
      const info = (COL==='events')
        ? `<div style="padding:12px 14px;border:1px solid #eee;border-radius:8px;background:#fcfcfc;margin-bottom:14px">
             <strong style="color:var(--ink)">${esc(d.title||'')}</strong><br/>
             <span style="color:#666">${d.date? ymd(toDate(d.date)) : ''}${d.time? ' Â· '+esc(d.time):''}${d.place? ' Â· '+esc(d.place):''}</span>
           </div>` : '';
      if (rawHtml) contentEl.innerHTML = info + rawHtml;
      else if (rawText) contentEl.innerHTML = info + String(rawText).replace(/\n/g,'<br>');
      else contentEl.innerHTML = info + '<p>-</p>';
    }

    // ì‚¬ì§„í˜•(ê°¤ëŸ¬ë¦¬/í–‰ì‚¬ì‚¬ì§„)
    if (COL==='photos_gallery' || COL==='photos_events') {
      const images =
        (Array.isArray(d.attachments) && d.attachments.length>0
          ? d.attachments.map(a=>a.url||a).filter(Boolean)
          : [d.imageUrl].filter(Boolean));
      const rawHtml = d.contentHtml || d.bodyHtml || '';
      const rawText = d.content || d.body || d.memo || d.description || '';
      let desc = '';
      if (rawHtml) desc = rawHtml;
      else if (rawText) desc = `<div style="margin-top:12px">${String(rawText).replace(/\n/g,'<br>')}</div>`;

      if (images.length) {
        contentEl.innerHTML =
          `<img class="photo-hero" src="${images[0]}" alt="${esc(title)}">` + desc;
        if (images.length > 1) {
          contentEl.insertAdjacentHTML(
            'beforeend',
            `<div class="grid-photos">${images.slice(1).map(u=>`<img src="${u}" alt="">`).join('')}</div>`
          );
        }
      } else {
        contentEl.innerHTML = desc || '<p>-</p>';
      }
    }

    // ì²¨ë¶€íŒŒì¼
    const attach = $('#attach');

// â˜… ì‚¬ì§„ ê³„ì—´ì€ ì²¨ë¶€ ë°•ìŠ¤ë¥¼ ì•„ì˜ˆ ìˆ¨ê¹€
if (COL === 'photos_gallery' || COL === 'photos_events') {
  attach.style.display = 'none';
} else {
  const files = (d.files || d.attachments || [])
    .map(x => (x.url ? x : { url: x, name: x.name || 'ì²¨ë¶€íŒŒì¼' }))
    .filter(f => !!f.url);

  if (files.length) {
    attach.style.display = 'block';
    attach.innerHTML =
      `<h4>ì²¨ë¶€íŒŒì¼</h4>` +
      files.map(f =>
        `<a href="${f.url}" target="_blank" rel="noopener">ğŸ“ ${esc(f.name || 'íŒŒì¼')}</a>`
      ).join(' ');
  } else {
    attach.style.display = 'none';
  }
}

    // ì¡°íšŒìˆ˜ +1 (ê¶Œí•œ ì—†ìœ¼ë©´ ë¬´ì‹œ)
    try{ await docRef.update({ views: firebase.firestore.FieldValue.increment(1) }); }catch(e){}

    // ì´ì „/ë‹¤ìŒ
    try{
      const sortField = d.createdAt ? 'createdAt' : (d.date ? 'date' : null);
      const baseTs    = d[sortField];
      if (sortField && baseTs) {
        const newer = await db.collection(COL).orderBy(sortField,'desc').startAfter(baseTs).limit(1).get();
        if (!newer.empty) {
          const nd = newer.docs[0];
          $('#nextLink').style.visibility = 'visible';
          $('#nextLink').href = `view.html?col=${COL}&id=${nd.id}`;
        }
        const older = await db.collection(COL).orderBy(sortField,'desc').endBefore(baseTs).limitToLast(1).get();
        if (!older.empty) {
          const od = older.docs[0];
          $('#prevLink').style.visibility = 'visible';
          $('#prevLink').href = `view.html?col=${COL}&id=${od.id}`;
        }
      }
    }catch(_) {}
  }catch(err){
    console.error(err);
    $('#title').textContent = 'ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨';
    $('#content').innerHTML = `<p style="color:#b00">ì˜¤ë¥˜: ${esc(err.message||err)}</p>`;
  }
}

/* íˆì–´ë¡œ ë¨¼ì €, ê·¸ ë‹¤ìŒ ë°ì´í„° */
renderHero();
load();

/* Back to Top */
const toTopBtn = document.getElementById('toTop');
window.addEventListener('scroll', () => {
  toTopBtn.style.display = (window.scrollY > 300) ? 'block' : 'none';
});
toTopBtn.addEventListener('click', () => {
  window.scrollTo({ top: 0, behavior: 'smooth' });
});
</script>

</body>
</html>
